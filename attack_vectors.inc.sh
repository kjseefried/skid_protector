# Attack Vectors
# ----------------------------------------------------------------------------
# These are a list of substrings in the web server access logs that indicate
# suspicious or attack activity.  An attack is when an attack string appears
# with a HTTP error (e.g. a request for something that is not found).  A
# suspicious hit is when a suspicious string appears with a successful
# request (e.g. HTTP 200).  An attack string is a string that should never
# appear and is typical of probes for vulnerabilities or non-existent
# pages.  A suspcious string is matches URL's that users may visit but
# excessive visits may indicate an attack attempt (e.g. a login page).
# The substrings are case-sensitive.
#
# Blocking by these substrings does not prevent an attack: it disrupts
# brute-force scans.  To prevent attacks, you'll need to install and
# configure Apache mod_security or a web security proxy.
#
# See also wb_whitelist and wb_blacklist to set ip's that are always
# allowed, or always denied, no matter what URL's they use.
#
# Attack URL's fall can be categorized in this way:
#
# - newbie pages (e.g.test.php) that may have no security
# - obvious attack pages/directories (e.g. contact.php, assets.php)
# - attackers so dumb that they declare themselves
# - form data injection
# - javascript, PHP, C, shell, etc. code injection
# - probes for common software (e.g. wp-login.php - wordpress)
# - common files with vulnerabilities
# - redirections and unusual protocols (e.g. sip:)
#
# Other attack substring notes.
#
# The %41, etc. are the upper-case letters in URL encoding.  These are not
# normally URL encoded so they indicate someone trying to hide text.
#
# /00/ to /09/ are typical hash directory names so are blocked.
#
# SlurpConfirm404, SlurpConfirm404.htm, SlurpConfirm404.html or
# SlurpConfirm404.php are permitted: this is Yahoo checking your
# HTTP 404 handling.
#
# Connections to ftp.gov -> default used by fhscanhttplibrary on Google
# Code.
#
# \x hex codes are an attempt to put PHP escape characters in a string.
# Technically, they are illegal in HTTP.  It's difficult to check for \\x
# because they also get escaped in the shell, so we check explicitly for
# '\x' in the HTTP 400s test function, rather than list them here.
#
# Autodiscover is a search for an exchange server.  It is used by spammers
# but I'm not 100% certain that it's always wrong.
#
# no+post+sending+forms+are+found is related to xulrunner, not sure if it
# should be treated as an attack.
#
# 0x - matches many things of the form a x b.  so use leading /
#
# See also: https://bitbucket.org/lazy_dogtown/doxi-rules/src
#           https://github.com/nbs-system/naxsi
#           http://www.w3schools.com/tags/ref_urlencode.asp
#           http://www.jayssite.com/stuff/l33t/l33t_translator.html
# ----------------------------------------------------------------------------

declare -r ATTACK_PAGES="/dev/shm/attack_pages_$$.txt"

cat > "$ATTACK_PAGES" <<DONE
-=
===
=http://
=https://
+++
/-c/
*
%00
%0A
/%2A
/%24
/%7B
:)
/%20
/+
GET /\"
GET /en/\"
GET /fr/\"
/%22
/\'
/%27
%41
%42
%43
%44
%45
%46
%47
%48
%49
%4A
%4B
%4C
%4D
%4E
%4F
%50
%51
%52
%53
%54
%55
%56
%57
%58
%59
%5A
%61
%62
%63
%64
%65
%66
%67
%68
%69
%6A
%6B
%6C
%6D
%6E
%6F
%70
%71
%72
%73
%74
%75
%76
%77
%78
%79
%7A
/00/
/01/
/02/
/03/
/04/
/05/
/06/
/07/
/08/
/09/
/10/
/[~
/%5B~
/0x
/.0
?1=
/&
&a=
&b=
&c=
&d=
&e=
&f=
&g=
&h=
&i=
&j=
&k=
&m=
&n=
&o=
&p=
&q=
&r=
&s=
&t=
&u=
&v=
&w=
&=
&y=
&z=
123456
123abc
123123
/3rdparty
/3xp.php
/8080
/99billdo.php
AAAAA
/a HTTP
/a1x3g6ythu
/about_management.html
/accepted-WebTac_Notify
/access_log
/account
&act=register
/action-blog
/actus4
add_comment.asp
add_comment.cgi
add_comment.php
addEventListener
?adduser=
adduser.asp
adduser.cgi
adduser.php
/adimages
/adm/
/_admin
admin.asp
admin.cgi
admin.php
4dm1n.php
administrator
Administrator
administration
Administration
administrateur
administraci
adminpanel
AdoDBConnection.php
/ajax/
?ads_file=
&ads_file=
/asdf
/anmelden
allow_url_include
allrequestsallowed
/alma/
/and/
antisec
anti-sec
/apache-default
/api/
/API/
/api-key/
/apikey/
/api-keys/
/apikeys/
/application/x-ecmascript
/application/x-shockwave-flash
/application/x-www-form-urlencoded
ar.com.unomedios.openid
/archive
?arquivo=
&arquivo=
assailer
attacker
/axa.php
/Autodiscover.xml
/autodiscover.xml
/Autodiscover.svc
/autodiscover.svc
/bkup/
/back/
/_back/
/BACK/
/backend/
/Backend/
/backoffice/
/backup/
/backup_timeout.php?lang=
.bak
/bak/
/_bak/
?base=
&base=
basedir=
basepath=
baseurl=
BASEDIR=
BASEPATH=
BASEURL=
/base/
/_base/
/BASE/
/_BASE/
bash+
bash%20
/bbadmin
/bbs
/bitrix
/banner_manager
/bannermanager
/bdd/
/_bdd/
/BDD/
/_BDD/
?bibtexrootrel=
&bibtexrootrel=
/bkp/
/_bkp/
/BKP/
/_BKP/
blackcat
blackhat
/blah
blitz
/blog/
?blog_theme=
&blog_theme=
/board/
/boards/
/bogus
bokeindex.asp
bojog.php
/boo+
BOT for JCE
busybox
/c/en/
cache_file=
cd+/
cd%20/
cfgIncludeDirectory=
cfg_file=
/CFIDE
/cgi-bin/php-cgi
/cgi-bin/php.cgi
cgi.force_redirect
cgi.redirect_status_env
/ch01.html
/ch02.html
/ch03.html
/ch04.html
/ch05.html
/ch06.html
/ch07.html
/ch08.html
/ch09.html
/CHANGELOG
/chat/
/checkbox/
chmod&20
chown&20
/cltreq.asp
/class
/Class
?classdir=
&classdir=
&cmd=
?cmd=
&cms=
?cms=
/codepress
/com_community
/community/
/command.js
/components
/config
?_CONFIG
&_CONFIG
?config[
&config[
?CONFIG[
&CONFIG[
config_atkroot=
?configuration=
&configuration=
/console
/content/
/contenido/
_ctf=\"rdr_T
/k0N50L3
contentdir=
contentpath=
contenturl=
CONTENTDIR=
CONTENTPATH=
CONTENTURL=
/controllers
/controlpanel
cp+
cp%20
/cp_errordocument.shtml
/cpanel
/cpphpmyadmin
CreateUser.asp
/crons/
/cronjobs/
/crypto
/Crypto
/_crypto
/_Crypto
/CSUpload.cgi
/CTRSHTMLElement.js
curl+
curl%
/custom/
/cuteeditor
data:
/data/
/_data/
/datas/
/_datas/
/database/
/_database/
?dateiPfad=
&dateiPfad=
/db/
/_db/
/dbdump
?dgc=
?de=
&de=
delete_comment.asp
delete_comment.cgi
delete_comment.php
/demo/
?dept=
&dept=
/detail.php
/digg.php
_dir=
_DIR=
?dir_src=
&dir_src=
dir_admin=
DIR_ADMIN=
djpage.php?page=
/dl/
/_dl/
.dll
/dloads-payed.php?docroot=
?do=
&do=
/do.php
document.location
DOCUMENT_ROOT
/DOMready/
/donnees
/drupal
/dummy
/dump/
/_dump/
/DUMP/
/_DUMP/
/dumped/
/_dumped/
/DUMPED/
/_DUMPED/
/dumps/
/_dumps/
/DUMPS/
/_DUMPS/
Edition Campaign
Edition Yx
/ecmascript
/echange/
/editor
/EDITOR
/edoas2
/email/
/emails/
emi.php
.empty(
/en/assets/
/en/feature/assets/
/en/feature/en/
/en/fr/
/epgrec/
/error/
/Error/
/errors.php?error=
/etc/
/-event.detail
/event.wheelDelta
/eWebEditor
/examples/
/exchange/
/extensions/
?exec=
&exec=
exec+
exec%20
?ext=
&ext=
/export/
/exports/
/extern/
/extranet/
/extras
/facebook/
/_facebook/
/Factux/
/FastHTTPAuthScanner200test
/fake
fanatik
FaTaLisTiCz_Fx
/fb/
/_fb/
/Fck/
/FCK/
/fck/
/FCKeditor
/fckeditor
/jeeventcalendar
/fichier/
/fichiers/
/fileadmin/
fileloc=
/file_manager
/filemanager
file_name=
file_name[
filename=
filnavn=
_files/filelist.xml
/Files/
.find(
/find/
finance
ph1n4nc3
flashchat.php
/focus/
/focusin/
/folder/
/Folder/
/foobar
/food.php?rf
/footer.php
forgot_password.asp
forgot_password.cgi
forgot_password.php
/forum
/frontpage
/ftp/
/_ftp/
/FTP/
/_FTP/
/fullsuspension
?func=
&func=
?function=
&function=
/fonction/
/function/
/fonctions/
/functions/
function(
FunWebProducts
/gbook
?gen=
&gen=
?get=
&get=
/get/
/getpass.cgi
/getter/
?globalIncludeFilePath=
?gOo=
&gOo=
?gotopage=
&gotopage=
GLOBALS
grep+
grep20
/hack/
hax0r
hacksyou
hackzyou
/hble
/history.txt
/HNAP1
/hoarde
homedir=
HOMEDIR=
home_name=
/htdocs
.html(
/htmleditor
iamjustsendingthisleter
/ipb/
/id/
/_id/
/ID/
/_ID/
/ids/
/_ids/
/IDs/
/_IDs/
/?id=
/IE6/
/IE7/
/IE8/
IFS
?ilang=
&ilang=
iloveyou
/image.php?url=
/import/
/imports/
?inc=
&inc=
?INC=
&INC=
incdir=
incldir=
inclpage=
inclurl=
INCLDIR=
INCLPAGE=
INCLURL=
incl_page=
INCL_PAGE=
include=
includeDir=
includesdir=
includeFooter=
include_page=
INCLUDE_PAGE=
/inc/
/Inc/
/incl/
/_incl/
/include
/_include
/Include
incursion
index.php?option=
index.php?page=
index.php?pagename=
index.php?src=
index.php?templatee=
index.php?type=
/index_voipgate.cgi
/inhalt.php?dateien
?insPath=
/install/
/install.php
/INSTALL.PHP
/install.txt
/INSTALL.TXT
/intern/
/internal/
/intranet/
invasion
/invoker
ipcrawl
ipinspect
ipscan
ipspider
ipsweep
ip4bot
ip4crawl
ip4inspect
ip4scan
ip4spider
ip4sweep
ipv4bot
ipv4crawl
ipv4inspect
ipv4scan
ipv4spider
ipv4sweep
ip6bot
ip6crawl
ip6inspect
ip6scan
ip6spider
ip6sweep
ipv6bot
ipv6crawl
ipv6inspect
ipv6scan
ipv6spider
ipv6sweep
javascript:
jce.php
jcmsU1.js
JMXInvokerServlet
/jquery.colorbox-min.js
/json/
/key/
/Key/
/_key/
/_Key/
/keys/
/Keys/
/_keys/
/_Keys/
/leading/
?libdir=
&libdir=
/license.txt
/licence.txt
/listadmin
/LIVE_VIEW.asp
?lizge=
/local-bin/php-cgi
/local-bin/php.cgi
?location=
&location=
/log/
/logs/
.log
logging.php
login.asp
login.cgi
login.php
login.jsp
login_form.php
?lol=
&lol=
join.asp
join.cgi
join.php
join_form.php
/joomla
kanrisha
/kindeditor
/License.txt
/loaded/
/mail/
/mail.asp
/mail.cgi
/mail.php
/mailbox/
/mailboxes/
/mailman
/mails/
maindir=
mainpath=
mainurl=
MAINDIR=
MAILPATH=
MAINURL=
/maticmarket
/mbox/
/mdb/
/mdbs/
member.asp
member.cgi
member.php
/message/
/messages/
/messagerie/
/manage/
/mgiit.html
/minidom
modules.php
Morfeus
mosConfig_live_site=
/mouse/
/mouseenter/
/mouseover/
/ms-sql/
/mssql/
/MSOffice
/MuraProxy.cfc
/music/album.html?cid=
/mybb_theme.xml
/mydataadmin
mybic_server.php
mygallerybrowser.php
mv+
mv%20
mvn:
/myaccount
/myadmin
/MyAdmin
/mysql/
/mysqladmin
/mysql-admin
/nav/mkpr
/news.php
netbot
netcrawl
netinspect
netscan
netspider
netsweep
/nonauth
/non-null/
/nosuchfile
/no_such_file
/no+such+file
/no%20such%20file
/notreal
/not_real
/not+real
/not%20real
/node/add
/not-null/
/null/
offensive
/oidtable.cgi
.old
/old/
onchange
onclick
onfocus
onload
onmousedown
onmouseover
onmouseout
onmouseup
onslaught
onunload
open_basedir
open.aspx
option=com_awdwall&controller=
option=com_bca-rss-syndicator&controller=
option=com_biblestudy&id=1&view=studieslist&controller=
option=com_dailymeals&view=dailymeals&controller=
option=com_jce
option=com_loginbox&view=
option=com_realtyna&controller=
option=com_vjdeo&controller=
/or/
order.asp
order.cgi
order.php
/out/
ownzyou
/pages/
?pages[
&pages[
?PAGES[
&PAGES[
/Page does not exist
/Page%20does%20not%20exist
/Page+does+not+exist
/Pagedoesnotexist
/page.asp
/page.cgi
/page.html
/page.php
?pagewanted=
&pagewanted=
/pandora_help.php?id=
password_forgotten.php
_path=
_PATH=
&path=
?path=
path[counter]=
pcltar.lib.php
perl+
perl%20
/Petite/Moyenne/
php+
php%20
phpdirectorgameedition/header.php?lang=
/phpmanager
/phony
/phpldapadmin
/phppath
/php-my
/PHPMY
/pHpMy
/phpMy
/phpmy
/_PHPMY
/_phpMy
/_phpmy
/P/M/A
/p/m/a
/PMA
playerurl
/plesk
post.asp
post.cgi
post.php
prefix=
PREFIX=
printf%28
printf%20
printf+
/private
/_private
/proc/
product.asp
product.cgi
product.php
profile.php
/Providers
/ptcmd.cgi
/PublicJS.js
putenv%28
putenv%20
putenv+
qwerty
/quicklogin.one
\"quit\"
/racrew.php
raider
/readme
/README
redirect.php?url=
reg.asp
reg.cgi
reg.php
register.asp
register.cgi
register.php
registration_rules.asp
registration-success.html
/registration
repertorylevel=
/Request.xml
?_REQUEST=
&_REQUEST=
/requests.html
?reset_password=
/Resource
/Response.xml
/RK=
/RS=
rm+
rm%20
rmi:
/rom-0
_root=
_ROOT=
~root
rootdir=
rootpath=
root_path_admin=
rooturl=
ROOTDIR=
ROOTPATH=
ROOTURL=
/roundcube
?row[
&row[
/rtki.you
/rtpd.cgi
/rutorrent
safe_mode
sales
/sauv/
/sauve/
/sauvegarde
/save/
/_save/
/saved/
/_saved/
<script>
/SCRIPT
/section.php?Module_Text=
/seeAlbum
/SendAlertEmail.php
/SENDATASRVR/
/set/
/seti.php?ps_cfg_langfiles=
/setter/
/setup/
/s37up
/setup.php
?_SERVER
&_SERVER
shell
Shell
SheLL
/shop
shopping_cart.asp
shopping_cart.cgi
shopping_cart.php
?show=
&show=
/showenv
/showphoto.php?pid=
/sign_up
/signup
signup.asp
signup.cgi
signup.php
sip:
&site=
?site=
/siteadmin
/site_plugin.php
sitebase=
SITE_BASE=
site_base=
siteurl=
skel_null.php
skindir=
skype:
/small/mid/
/Small/Mid/
smb:
/snapshot.cgi
/snippet.reflect.php
/soapCaller.bs
/SoftwareVersionList.txt
/soumettre.php
soustab.php
/Southidceditor
/spare/
/sp_strategic.html
/sp_stratNews.html
/spywall/releasenotes.php
.sql
sqlbackup
sqldump
/SQLite
/SQlite
/sqlite
sqlmanager
/sqlpatch.php
sqlweb
/sprawdza.php
/staging/
/status?
/submit.php
/success
/Success
/super/
/Super/
/Super-Admin
/supervise
/SysAdmin
/sys/
/sysadmin
/system/
/System.xml
tar+
tar%20
/tel:
/test.asp
/test.cgi
/test.html
/test.php
/text/
/ThinkPHP
thisisjusttestletter
/tell_a_friend/tell.php
threadstop.php
thumbUrl
/timthumb.php
tip:
/<title>JBoss
/tmp/
/_tmp/
/tools
/t00ls
/trackback
/trailing/
/trans/
/_trans/
/transfer/
/_transfer/
/true/
/try/
XMPP Tiscali Communicator
/typo3
/typecho.js
ucp.php
undocumented
/ueditor
/UNKNOWN
upload.asp
upload.cgi
upload.php
upload_image.asp
upload_image.cgi
upload_image.php
uploadify.php
/up/
/_up/
/upl/
/_upl/
/upload/
/_upload/
/uploaded/
/_uploaded/
/uploads/
/_uploads/
/uploadtest.html
&url=
_url=
_URL=
+URL=
%20URL=
/URLRewrite
/user/
/users/
/value/
/verify-WebTac_Notify
/verify_user
/version.txt
/ViAr.php
/vicidial/project_auth_entries.txt
view_func.php
/virtuemart.xml
/_vti_bin
/_vti_cnf
/_vti_inf.html
/VoIP
/vtigercrm
w00t
washere
wazhere
web-console
/Web_Editor
/webedit
/webmail
/w38M41l
webadmin
w384DM1N
/w6/
/wc/
/webc/
WebCalendar
webcalendar
/webdav/
webdb
/webmaster
/WebMaster
websql
wget+
wget%20
/WHMCS
whitehat
whoami
wizard.php
/wp-config
/wp-content
/wp-includes
/wp-php
/wp-my
wp-admin
/wordpress
/ws_ftp
/WS_FTP
/_www/
/?WT.ac=
?xajax=SelTheme&xajaxargs
/xampp
/_xml/
xmlrpc.php
/vbforum
/vbulletin
/vito.php
YaBB.cgi
YaBB.pl
/zabbix
/zcadmin
zealots
/zip/
/_zip/
/zips/
/_zips/
/zipfiles/
/_zipfiles/
Zmeu
ZmEu
Zollard
/Zongg
CONNECT
&hl=
&amp;hl=
&plugin=imgmanager
&amp;plugin=imgmanager
/?author=
alter table
alter+table
alter%20table
ALTER TABLE
ALTER+TABLE
ALTER%20TABLE
delete from
delete+from
delete%20from
DELETE FROM
DELETE+FROM
DELETE%20FROM
drop table
drop+table
drop%20table
DROP TABLE
DROP+TABLE
DROP%20TABLE
create table
create+table
create%20table
CREATE TABLE
CREATE+TABLE
CREATE%20TABLE
insert into
insert+into
insert%20into 
INSERT INTO
INSERT+INTO
INSERT%20INTO
OR 1=1
OR+1=1
OR%201=1
or 1=1
or+1=1
or%201=1
SELECT %2A FROM
SELECT+%2A+FROM
SELECT%20%2A%20FROM
DONE

# Weird exceptions to the list above.  Exclude anything that matches here.

# TODO: clean these up...these should be 404's only

declare -r ATTACK_PAGE_EXCEPTIONS="/dev/shm/attack_page_exceptions_$$.txt"
cat > "$ATTACK_PAGE_EXCEPTIONS" <<DONE
DONE


# Suspicious Pages
#
# These are the same as attack pages, but these match pages we actually have
# so they are not an automatic block but they are suspicious.  This also include
# obvious attack points that we have, such as login pages.  Case sensitive.
# Suspecious pages will weight higher in the tests.
#
# This includes bad top-levels url's that may redirect to the front page
# (e.g. /index.php, etc) that are also listed in the attack pages.
#
# /en/aboutus/executiveteam.html being accessed by some even though doesn't exist
# one IP accessing it every 30 seconds.
#
# index.php is an attack point because it is always present so it won't show up
# as a 404 for the 400's scans.  ?_SERVER, etc. can be an attempt to see if PHP
# is installed.  Ideally, index.php attacks should be treated the same as a 400
# attack but for now we'll treat them as suspicious.
#
# one of the problems of suspicious pages is when an organization users multiple
# users: they will, for example, each load jquery with a 200, creating multiple
# hits if jquery is a suspicious page
# ----------------------------------------------------------------------------

declare -r SUSP_PAGES="/dev/shm/susp_pages_$$.txt"

cat > "$SUSP_PAGES" <<DONE
/mailman
=http://
/board-post.cgi
/board-admin.cgi
&cmd=
?cmd=
/forum
AAAAA
?do=
index.php?option=
?pagewanted=all
&plugin=imgmanager
allow_url_include
allrequestsallowed.com
robots.txt
/search.cgi
/site
/unsubscribe.html
/wiki
/?WT.ac=
DONE

